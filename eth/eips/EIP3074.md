## EIP-3074: AUTH 和 AUTHCALL 操作码

EIP-3074 是一项提议的以太坊升级，旨在通过引入两个新的操作码 `AUTH` 和 `AUTHCALL`，赋予外部拥有账户（EOA）类似智能合约的功能。

### 解决的问题
虽然 ERC-4337 提供了账户抽象的解决方案，但它主要针对新的智能合约钱包用户。对于现有的数亿 EOA 用户（MetaMask 用户），迁移到智能合约钱包成本高昂且繁琐。EIP-3074 旨在让现有的 EOA 也能享受到批量交易、Gas 代付等高级功能，而无需迁移资产。

### 实现机制与原理
EIP-3074 引入了“调用者合约”（Invoker Contract）的概念：

1.  **AUTH (授权):**
    *   用户（EOA）使用私钥签署一条包含特定格式的消息（Commitment）。
    *   调用者合约（Invoker）接收该签名，并执行 `AUTH` 操作码。
    *   EVM 验证签名，并将该 EOA 的地址设置在一个临时的上下文变量中（`authorized`），表明该合约已获得该 EOA 的授权。

2.  **AUTHCALL (授权调用):**
    *   一旦授权成功，调用者合约可以执行 `AUTHCALL` 操作码。
    *   `AUTHCALL` 类似于 `CALL`，但它会将发送者（`msg.sender`）设置为刚才通过 `AUTH` 授权的 EOA 地址，而不是调用者合约本身的地址。
    *   这意味着调用者合约可以“伪装”成 EOA 发起交易。

### 主要特点
*   **EOA 赋能:** 让现有钱包瞬间获得账户抽象的能力。
*   **批量交易:** 用户签署一次，Invoker 可以代表用户执行一系列操作（如 `approve` 和 `transferFrom`）。
*   **Gas 代付:** Invoker 可以支付 Gas，用户无需持有 ETH。
*   **安全性:** 高度依赖 Invoker 合约的安全性。如果是恶意的 Invoker，可能会窃取用户资产。因此，预计未来钱包会通过白名单机制限制用户可以授权的 Invoker。

### 状态
EIP-3074 已被计划纳入未来的以太坊硬分叉升级（如 Pectra 升级），但社区中对于应该优先支持 EIP-3074 还是更加纯粹的账户抽象路径（如 EIP-7702）仍有讨论。

### 推荐阅读
*   [EIP-3074 Standard](https://eips.ethereum.org/EIPS/eip-3074)
*   [Understanding EIP-3074](https://www.paradigm.xyz/2021/04/understanding-ethereum-eip-3074)
