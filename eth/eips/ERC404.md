## ERC-404

### 概念简介

ERC-404 是一个实验性的"半同质化代币"（Semi-Fungible Token）标准，由化名开发者"ctrl"和"Acme"于 2024 年初创建。这个标准试图将 ERC-20（同质化代币）和 ERC-721（NFT）的特性融合到单个代币中，实现 NFT 的原生分割化（Native Fractionalization）。

**重要警告**：ERC-404 是一个实验性、非官方的标准，尚未提交为正式的 EIP（以太坊改进提案），也未经过完整的外部安全审计。使用时需谨慎评估风险。

### 核心概念

**什么是半同质化**
ERC-404 代币同时具有两种属性：
- **同质化部分**：可以像 ERC-20 一样分割和交易
- **非同质化部分**：持有整数代币时自动拥有对应的 NFT

**铸造-销毁机制**
核心运作方式：
- 持有 1 个完整代币 → 自动铸造 1 个 NFT
- 代币分割到小于 1 → NFT 被销毁
- 重新获得 1 个完整代币 → 铸造新的 NFT

### 工作原理

**代币与 NFT 的动态绑定**

**场景 1：购买整数代币**
```
用户购买 1 个 $PANDORA 代币
→ 自动铸造 1 个 Pandora NFT 到用户钱包
→ NFT 具有独特的视觉特征和稀有度
```

**场景 2：出售部分代币**
```
用户出售 0.3 $PANDORA
→ 剩余 0.7 代币（不足 1 个）
→ 关联的 NFT 被自动销毁
→ 用户只持有 0.7 同质化代币
```

**场景 3：重新获得整数代币**
```
用户再购买 0.5 $PANDORA
→ 总计 1.2 代币
→ 自动铸造新的 NFT
→ NFT 的特征可能与之前不同
```

**场景 4：持有多个整数代币**
```
用户持有 3.7 $PANDORA
→ 拥有 3 个 NFT（对应 3 个完整代币）
→ 剩余 0.7 作为同质化代币
```

### 技术实现

**合约结构**
```solidity
contract ERC404 {
    // ERC-20 状态
    mapping(address => uint256) public balances;
    uint256 public totalSupply;

    // ERC-721 状态
    mapping(uint256 => address) public ownerOf;
    mapping(address => uint256[]) public tokensOfOwner;
    uint256 public nftIdCounter;

    // 转账时的逻辑
    function transfer(address to, uint256 amount) public {
        _transferFungible(msg.sender, to, amount);
        _updateNFTs(msg.sender);
        _updateNFTs(to);
    }

    function _updateNFTs(address user) internal {
        uint256 balance = balances[user];
        uint256 nftCount = balance / UNIT;  // 应该持有的 NFT 数量
        uint256 currentNftCount = tokensOfOwner[user].length;

        if (nftCount > currentNftCount) {
            // 铸造 NFT
            for (uint i = 0; i < nftCount - currentNftCount; i++) {
                _mintNFT(user);
            }
        } else if (nftCount < currentNftCount) {
            // 销毁 NFT
            for (uint i = 0; i < currentNftCount - nftCount; i++) {
                _burnNFT(user);
            }
        }
    }
}
```

### 关键特性

**原生分割化**
- 无需额外的分割协议
- NFT 自动与代币余额同步
- 简化的用户体验

**流动性增强**
- NFT 持有者可以随时在 DEX 上出售部分代币
- 不需要找到买家购买整个 NFT
- 降低了 NFT 的流动性门槛

**投机新玩法**
- 每次重新获得整数代币时铸造新 NFT
- NFT 的稀有度随机
- 创造了"开盲盒"式的游戏性

### 应用场景

**流动性 NFT**
- 蓝筹 NFT 的分割交易
- 部分所有权市场
- 降低高价 NFT 的准入门槛

**游戏资产**
- 游戏内代币与装备的结合
- 持有代币即拥有游戏角色或道具
- 可交易的游戏经济

**社区代币**
- 持有社区代币的同时获得会员 NFT
- 代币数量与会员等级挂钩
- 灵活的治理和奖励机制

### 知名项目

**Pandora ($PANDORA)**
- 第一个采用 ERC-404 的项目
- 2024 年 2 月推出
- 曾引发市场热潮
- 总供应量：10,000 代币/NFT

**DeFrogs**
- 社区驱动的 ERC-404 项目
- 独特的青蛙主题 NFT
- 实验性质的代币经济

**Monkees**
- 另一个早期的 ERC-404 项目
- 猴子主题的 NFT 系列
- 探索分割化 NFT 的可能性

### 优势

**流动性改善**
- NFT 持有者可以部分套现
- 无需等待买家购买整个 NFT
- DEX 提供即时流动性

**价格发现**
- 市场可以更准确地为 NFT 定价
- 避免传统 NFT 市场的低流动性
- 持续的价格更新

**可组合性**
- 可以在 Uniswap 等 DEX 上交易
- 与 DeFi 协议集成
- 作为抵押品使用

**新颖性**
- 创新的代币机制
- 吸引投机者和收藏者
- 社区参与度高

### 缺陷和风险

**非官方标准**
- 未经 EIP 流程审查
- 没有社区广泛共识
- 可能存在设计缺陷

**未经充分审计**
- 缺乏专业安全审计
- 可能存在未发现的漏洞
- 合约风险较高

**高 Gas 成本**
- 每次转账都可能触发 NFT 铸造/销毁
- Gas 费用远高于普通 ERC-20
- 小额交易不经济

**NFT 随机性**
- 每次重获整数代币时 NFT 重新生成
- 原有的稀有 NFT 可能丢失
- 不适合真正的收藏品

**生态支持有限**
- 主流交易所不支持
- 钱包显示可能有问题
- NFT 市场兼容性差

**税务复杂性**
- 代币交易和 NFT 铸造/销毁的税务处理不明确
- 可能导致复杂的税务问题

### 对比 ERC-1155

ERC-404 vs ERC-1155（真正的半同质化标准）：

| 特性 | ERC-404 | ERC-1155 |
|------|---------|----------|
| 官方标准 | 否 | 是 |
| 审计情况 | 未充分审计 | 充分测试 |
| Gas 效率 | 低 | 高 |
| NFT 持久性 | NFT 会销毁重铸 | NFT 持久存在 |
| 市场支持 | 有限 | 广泛 |
| 分割机制 | 自动铸造/销毁 | 可分割供应量 |

**ERC-1155 的优势**：
- 官方标准，生态支持好
- Gas 效率高
- NFT 不会意外丢失
- 适合生产环境

**ERC-404 的独特性**：
- 自动的分割化机制
- 代币和 NFT 完全绑定
- 独特的投机性和游戏性

### 市场表现

**炒作周期**
ERC-404 经历了典型的加密货币炒作周期：
1. **初期（2024年2月）**：Pandora 推出，价格暴涨
2. **狂热期**：多个项目跟风，Gas 费飙升
3. **降温期**：炒作消退，价格回落
4. **现状**：小众市场，实验性质

**价格波动**
- Pandora 曾达到 30,000+ 美元/代币
- 大幅回调后稳定在较低水平
- 投机性远大于实用性

### 安全建议

**风险评估**
在使用 ERC-404 前考虑：
- ✗ 未经正式审计
- ✗ 非官方标准
- ✗ 高 Gas 成本
- ✗ NFT 可能丢失
- ✓ 创新机制
- ✓ 社区活跃

**投资警告**
- 仅投资可承受损失的金额
- 了解 NFT 铸造/销毁机制
- 注意 Gas 费用
- 关注合约安全

**开发建议**
如果要开发 ERC-404 项目：
- 进行充分的安全审计
- 考虑使用官方的 ERC-1155 替代
- 清楚告知用户风险
- 提供详细的机制说明

### 未来展望

**标准化可能性**
- ERC-404 可能最终提交为正式 EIP
- 需要社区审查和改进
- 与现有标准竞争

**替代方案**
更成熟的分割化方案：
- **ERC-1155**：官方的半同质化标准
- **Fractional.art**：NFT 分割协议
- **NFTX**：NFT 指数基金

**利基市场**
ERC-404 可能在以下场景存续：
- 投机性游戏
- 实验性项目
- 小规模社区代币

### 相关链接

- [ERC-404 GitHub（非官方）](https://github.com/Pandora-Labs-Org/erc404)
- [什么是 ERC-404（Decrypt）](https://decrypt.co/resources/what-is-erc-404-the-experimental-semi-fungible-ethereum-token-standard)
- [ERC-404 安全分析（Hacken）](https://hacken.io/discover/erc-404/)
- [Pandora 官网](https://www.pandora.build/)
- [ERC-1155 官方标准](https://eips.ethereum.org/EIPS/eip-1155)（官方替代方案）
