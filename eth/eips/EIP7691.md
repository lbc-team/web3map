## EIP-7691

### 概念简介

EIP-7691（Blob Throughput Increase）是以太坊 Pectra 升级的一部分，提议将每个区块的 blob 数量从当前的目标 3 / 最大 6 增加到目标 6 / 最大 9。这项提案旨在提高以太坊的数据可用性吞吐量，为 Layer 2 rollup 提供更多的区块空间。

该提案是 EIP-4844（Dencun 升级）的后续优化，在验证网络稳定性后进一步扩展 blob 容量。

### 背景

**Dencun 升级的成功**
2024 年 3 月的 Dencun 升级引入了 blob 交易（EIP-4844），设置了：
- 目标 blob 数量：3 个/区块
- 最大 blob 数量：6 个/区块

经过数月的监控，网络表现出色：
- 网络稳定性良好
- 重组率持续下降
- blob 利用率增长

**Layer 2 扩容需求**
随着 Layer 2 rollup 的快速发展，对数据可用性的需求不断增长：
- Optimism、Arbitrum、Base 等主流 rollup 大量使用 blob
- blob 空间时常供不应求
- 需要更多吞吐量来支持 L2 生态扩张

### 核心内容

**Blob 数量调整**

| 参数 | Dencun (旧) | Pectra (新) |
|------|------------|------------|
| 目标 blob 数/区块 | 3 | 6 |
| 最大 blob 数/区块 | 6 | 9 |
| 目标数据量/区块 | ~384 KB | ~768 KB |
| 最大数据量/区块 | ~768 KB | ~1.15 MB |

每个 blob 包含 128 KB 数据。

**实施细节**
从 Pectra 分叉的 epoch 开始：
```
TARGET_BLOBS_PER_BLOCK_ELECTRA = 6
MAX_BLOBS_PER_BLOCK_ELECTRA = 9
```

这些参数由共识层客户端使用，替换之前的值。

### 对 Layer 2 的影响

**更低的 L2 交易费用**
更多的 blob 空间意味着：
- Rollup 可以提交更多交易批次
- L2 用户的数据可用性成本降低
- L2 [Gas](https://learnblockchain.cn/tags/Gas?map=EVM) 费用进一步下降

**更高的吞吐量**
每个区块可以包含更多 L2 交易数据：
- 原来 ~384 KB 目标容量 → 现在 ~768 KB
- L2 TPS（每秒交易数）显著提升
- 支持更多并发的 L2 网络

**减少拥堵**
在 blob 空间紧张时：
- [Rollup](https://learnblockchain.cn/tags/Rollup) 需要竞价 blob 空间
- EIP-7691 增加供应，缓解竞争
- 更稳定的 L2 运营成本

### 网络影响

**带宽需求**
目标容量翻倍意味着：
- 节点需要下载更多数据
- 建议带宽：100 Mbps+
- 对家庭节点运营者的影响相对较小

**存储需求**
Blob 数据的临时性质：
- Blob 在共识层保留约 18 天
- 之后可以修剪（与 EIP-4444 配合）
- 长期存储压力不大

**验证负载**
更多 blob 意味着：
- 更多的 KZG 证明验证
- 对验证者硬件要求略有提升
- 但仍在可接受范围内

### 实施状态

**激活信息**
- **升级名称**：Pectra（Prague-Electra）
- **激活时间**：2025 年 5 月 7 日 10:05 UTC
- **激活 epoch**：364032
- **状态**：已在以太坊主网激活

**客户端支持**
所有主流以太坊客户端均已实现 EIP-7691：
- Geth
- Nethermind
- Besu
- Erigon
- Prysm（共识层）
- Lighthouse（共识层）
- Teku（共识层）
- Nimbus（共识层）

### 数据可用性策略

**短期解决方案**
EIP-7691 是临时性的吞吐量提升：
- 在等待 PeerDAS 等长期方案时提供过渡
- 验证网络在更高负载下的表现
- 为未来的扩容积累经验

**长期路线图**
以太坊数据可用性的长期规划：
1. **EIP-4844**（已完成）：引入 blob 基础设施
2. **EIP-7691**（已完成）：增加 blob 数量
3. **PeerDAS**（开发中）：分布式数据可用性采样
4. **Full Danksharding**（未来）：完全分片数据可用性

### 与其他提案的关系

**EIP-4844（Blob 交易）**
EIP-7691 直接建立在 EIP-4844 的基础上：
- 使用相同的 blob 数据结构
- 扩展 blob 容量参数
- 保持 blob 交易的临时性

**EIP-4444（历史数据过期）**
两者配合减轻存储负担：
- EIP-7691 增加临时数据量
- EIP-4444 删除历史数据
- 节点存储需求保持可控

**PeerDAS（数据可用性采样）**
EIP-7691 是 PeerDAS 之前的过渡方案：
- PeerDAS 将允许更大规模的数据可用性
- 节点无需下载所有 blob
- 实现真正的大规模扩容

### 监控指标

**关键指标**
以太坊基金会和社区持续监控：
- **区块传播时间**：blob 增加后的影响
- **重组率**：网络共识稳定性
- **Blob 利用率**：实际使用情况
- **节点性能**：验证者硬件负载

**成功标准**
如果以下指标保持健康，未来可能进一步增加：
- 重组率不上升
- 区块传播延迟可接受
- 节点参与率不下降

### 经济影响

**Blob 费用市场**
更多 blob 供应影响费用：
- Blob base fee 可能降低
- L2 成本相应下降
- 但仍保持 [EIP-1559](https://learnblockchain.cn/tags/EIP1559?map=EVM) 式的动态调整

**以太坊经济**
对 ETH 经济模型的影响：
- Blob 费用燃烧（销毁 ETH）
- 更多 blob 可能增加 ETH 燃烧量
- 但单价可能降低，总体影响待观察

### 对用户的意义

**L2 用户**
直接受益：
- 更低的交易费用
- 更快的交易确认
- 更好的 L2 用户体验

**L1 用户**
间接影响：
- L1 活动可能迁移到更便宜的 L2
- L1 拥堵可能缓解
- 整体[以太坊](https://learnblockchain.cn/tags/以太坊?map=EVM)生态扩容

**开发者**
新的可能性：
- 可以构建更高吞吐量的 L2 应用
- 数据密集型应用成为可能
- 跨 L2 互操作性改善

### 未来展望

**逐步扩容**
[以太坊](https://learnblockchain.cn/tags/以太坊?map=EVM)社区采用渐进式扩容策略：
- 先观察 6/9 blob 的影响
- 如果网络稳定，可能进一步增加
- 最终过渡到 PeerDAS

**生态系统演进**
EIP-7691 推动生态发展：
- L2 成为主要的用户交互层
- L1 专注于结算和数据可用性
- [Rollup](https://learnblockchain.cn/tags/Rollup)-centric 路线图的进一步实现

### 相关链接

- [EIP-7691 官方规范](https://learnblockchain.cn/docs/eips/EIPS/eip-7691)
- [Pectra 升级总览](https://ethereum.org/roadmap/pectra/)
- [EIP-7691 GitHub 讨论](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-7691.md)
- [以太坊数据可用性路线图](https://ethereum.org/roadmap/danksharding/)
