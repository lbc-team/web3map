# 一次性密封（Single-use Seals）

## 概念简介

一次性密封（Single-use Seals）是 Peter Todd 在 2016 年左右提出的密码学原语，是 RGB 协议的核心技术基础。一次性密封类似于物理世界中应用在容器上的密封条——一旦打开就无法重新密封，任何人都能看出容器已被打开。

在数字世界中，一次性密封是一种密码学承诺，承诺在未来某个时刻对一个（当前未知的）消息进行一次且仅一次的承诺，并且这个承诺的事实对特定受众是可证明的。

## 技术原理

**定义**
一次性密封是一个正式的承诺，保证：
1. 在未来某个时刻承诺一个消息
2. 只能承诺一次（单次使用）
3. 承诺的事实对所有相关方都是可证明的
4. 承诺是不可逆的和最终的

**在比特币上的实现**
- **密封定义**：比特币 UTXO
- **承诺**：哈希值被嵌入到比特币交易中
- **开启密封**：花费该 UTXO
- **唯一性保证**：比特币共识机制保证 UTXO 只能被花费一次

## RGB 协议中的应用

**状态转换**
RGB 使用定义在比特币交易输出上的一次性密封：
1. 智能合约的每个状态变化都绑定到一个比特币 UTXO
2. 状态变化的承诺嵌入到花费该 UTXO 的交易中
3. UTXO 的唯一性保证了状态转换的唯一性

**所有权映射**
- RGB 状态的所有权映射到比特币 UTXO 的所有权
- 比特币系统保证了 RGB 状态的所有权
- 通过 UTXO 历史可以追溯所有状态变化

**验证机制**
任何拥有智能合约状态历史的一方都可以验证其唯一性：
1. 检查每个状态转换是否绑定到有效的 UTXO
2. 验证 UTXO 是否已被正确花费
3. 确认没有双重花费或状态分叉

## 客户端侧验证

一次性密封是客户端侧验证（Client-side Validation）范式的关键组成部分：

**传统模式（全局共识）**
- 所有人验证所有交易
- 状态存储在区块链上
- 可扩展性受限

**CSV 模式（一次性密封）**
- 只有相关方验证相关交易
- 状态存储在链外
- 一次性密封保证唯一性
- 高度可扩展

## 优势

**隐私性**
- 合约状态不在区块链上公开
- 只有参与方知道完整的合约历史
- 链上只看到普通的[比特币](https://learnblockchain.cn/tags/比特币?map=BTC)交易

**可扩展性**
- 大幅减少链上数据量
- 验证成本不随全局状态增长
- 可以支持大规模应用

**安全性**
- 继承[比特币](https://learnblockchain.cn/tags/比特币?map=BTC)的安全保证
- 不可能产生双重花费
- 状态转换的最终性

## 应用场景

**RGB [智能合约](https://learnblockchain.cn/tags/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6)**
- 资产发行和转移
- 复杂的[智能合约](https://learnblockchain.cn/tags/%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6)逻辑
- [DeFi](https://learnblockchain.cn/tags/DeFi?map=EVM) 应用

**其他 CSV 协议**
- Taproot Assets
- RGB++（[CKB](https://learnblockchain.cn/tags/CKB) 上的扩展）
- 未来的客户端验证系统

## 理论意义

一次性密封代表了区块链设计的范式转变：
- 从全局共识到局部验证
- 从链上状态到链外状态
- 从透明到隐私
- 从低扩展性到高扩展性

这种设计理念可能影响未来区块链协议的发展方向。

## 推荐阅读

- [RGB Documentation](https://docs.rgb.info/distributed-computing-concepts/single-use-seals)
- [RGB Blackpaper](https://black-paper.rgb.tech/consensus-layer/3.-client-side-validation/3.2.-single-use-seals)
- [RGB Protocol](https://rgb.info/)

## 相关概念

- **RGB 协议**
- **客户端侧验证 (Client-Side Validation)**
- **UTXO 模型**
- **Peter Todd**
- **Taproot Assets**
- **状态通道**
