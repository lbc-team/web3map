# ElGamal 加密算法

## 概念简介

ElGamal 加密算法是由 Taher Elgamal 在 1985 年提出的一种非对称加密算法，基于 Diffie-Hellman 密钥交换，实现了语义安全性。该算法基于模算术中的离散对数困难问题来实现加密。

ElGamal 是除了 RSA 之外，另一个著名的非对称加密算法，被 ISO 国际标准采用。

## 核心特性

**非对称加密**：ElGamal 是一个非对称的加解密系统，有一对密钥，其中一个是公钥，另一个是私钥。

**同态性**：ElGamal 加密满足乘法同态性，即 E(m₁) · E(m₂) = E(m₁ · m₂)。这意味着两个密文相乘等于明文相乘后的密文。

**椭圆曲线变体**：椭圆曲线 ElGamal（EC-ElGamal）可以实现加法同态，即 E(m₁) + E(m₂) = E(m₁ + m₂)，这在某些应用中更有用。

**随机化加密**：ElGamal 在加密时使用随机数 k，这意味着同一明文加密两次会得到不同的密文，提高了安全性。

## 技术原理

**密钥生成：**
1. 选择大素数 p 和生成元 g
2. 选择私钥 x（随机数）
3. 计算公钥 y = g^x mod p
4. 公钥为 (p, g, y)，私钥为 x

**加密过程：**
1. 选择随机数 k
2. 计算 c₁ = g^k mod p
3. 计算 c₂ = m · y^k mod p
4. 密文为 (c₁, c₂)

**解密过程：**
1. 计算 s = c₁^x mod p
2. 计算 m = c₂ · s^(-1) mod p

## 应用场景

**电子投票**：利用同态性，可以在不解密单个投票的情况下统计总票数。

**安全多方计算**：在多方计算中，各方可以对加密数据进行计算而不泄露原始数据。

**混合加密系统**：常用于密钥封装机制（KEM），与对称加密结合使用。

**数字签名**：ElGamal 也可用于构造数字签名方案（ElGamal 签名）。

## 与 RSA 对比

| 特性 | ElGamal | RSA |
|------|---------|-----|
| 基础问题 | 离散对数 | 大数分解 |
| 密文大小 | 2倍明文 | 与明文相当 |
| 同态性 | 乘法同态 | 乘法同态 |
| 随机化 | 是 | 否（标准版本）|
| 标准化 | ISO 标准 | 广泛标准化 |

## 安全性

**离散对数困难性**：ElGamal 的安全性基于离散对数问题的困难性，目前没有有效的多项式时间算法解决这个问题。

**选择明文攻击**：ElGamal 对选择明文攻击（CPA）是安全的，因为其随机化特性。

**量子威胁**：与其他基于离散对数的系统一样，ElGamal 易受 Shor 量子算法攻击。

## 椭圆曲线 ElGamal

**EC-ElGamal**：在椭圆曲线上实现 ElGamal，具有更短的密钥长度和更高的效率。椭圆曲线版本可以实现加法同态，在某些应用中更加实用。

**应用**：EC-ElGamal 在区块链隐私保护、安全投票等场景中有广泛应用。

## 推荐阅读

- [ElGamal加解密算法 - CSDN](https://blog.csdn.net/u011583927/article/details/104104261)
- [ElGamal加密算法详解及实现 - 知乎](https://zhuanlan.zhihu.com/p/337013783)
- [深入理解ElGamal加密与同态性 - GeekMeta](https://www.geekmeta.com/article/3546293.html)

## 相关概念

- **Diffie-Hellman密钥交换**
- **离散对数问题**
- **同态加密**
- **[椭圆曲线密码学](https://learnblockchain.cn/tags/椭圆曲线密码学)**
- **RSA**
