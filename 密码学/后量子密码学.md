# 后量子密码学

## 概念简介

后量子密码学（Post-Quantum Cryptography, PQC），也称抗量子密码学，是指能够抵抗量子计算机攻击的密码学算法。随着量子计算技术的发展，传统的基于大整数分解（RSA）和离散对数（ECC、DH）的公钥密码系统将面临严重威胁。

后量子密码学旨在开发新的密码算法，即使在量子计算机存在的情况下也能保持安全性，为未来的数字安全提供保障。

## 量子威胁

**Shor 算法（1994）**：
- 可以在多项式时间内分解大整数
- 可以在多项式时间内解决离散对数问题
- 威胁目标：RSA、DSA、ECDSA、Diffie-Hellman、ECDH
- 估计需要约 2000-4000 个逻辑量子比特破解 RSA-2048

**Grover 算法（1996）**：
- 将搜索问题的复杂度从 O(2^n) 降至 O(2^(n/2))
- 威胁目标：对称加密算法（AES、ChaCha20）
- 对策：将密钥长度加倍（如从 AES-128 升级到 AES-256）

**时间表预测**：
- Google：计划 2030 年实现 100 万个物理量子比特
- 多数专家：预计 2030-2040 年间量子计算机可能威胁现有密码系统
- "现在收集，以后解密"：攻击者可能现在收集加密数据，等待量子计算机成熟后解密

## 主要方案

### 1. 格密码（Lattice-based）

**最有前景的方案**，基于格上的困难问题（如 LWE、NTRU）。

**优势：**
- 安全性基于最坏情况困难性假设
- 支持构造全同态加密（FHE）
- 密钥和密文相对较小
- 运算效率较高

**代表算法：**
- CRYSTALS-Kyber（密钥封装）
- CRYSTALS-Dilithium（数字签名）
- FALCON（紧凑签名）

### 2. 基于哈希的签名

**基于哈希函数**的一次性和多次签名方案。

**优势：**
- 安全性假设最小（仅依赖哈希函数）
- 成熟且被充分理解

**缺点：**
- 签名较大
- 有状态（需要跟踪签名次数）

**代表算法：**
- SPHINCS+（无状态）
- XMSS、LMS（有状态）

### 3. 基于编码的密码学

基于纠错码的困难性（如 McEliece）。

**优势：**
- 历史悠久（1978 年提出）
- 抗量子性强

**缺点：**
- 公钥非常大（数百 KB 到 MB 级别）

### 4. 多变量密码学

基于多变量多项式方程组求解的困难性。

**优势：**
- 签名生成和验证快速
- 签名较小

**缺点：**
- 密钥较大
- 安全性分析复杂

### 5. 基于同源的密码学

基于椭圆曲线同源计算的困难性。

**优势：**
- 密钥非常小

**缺点：**
- 计算较慢
- 最近发现安全性问题（SIKE 被破解）

## NIST 标准化进程

**时间线：**
- 2016：NIST 启动后量子密码标准化项目
- 2022：第三轮评估完成
- 2024：首批标准发布

**已选定标准（2024）：**

**密钥封装机制（KEM）：**
- CRYSTALS-Kyber（现更名为 ML-KEM）

**数字签名：**
- CRYSTALS-Dilithium（现更名为 ML-DSA）
- FALCON（FN-DSA）
- SPHINCS+（SLH-DSA）

**第四轮候选：**
- 继续评估额外的备选方案

## 中国后量子密码竞赛

**2018 年启动**：中国密码学会组织的后量子密码算法竞赛。

**结果（14 个获胜算法）：**
- **11 个格密码算法**：LAC、Aigis-enc、AKCN-E8、CNKE、Panda、NTTRU-KE、OKCN/T、AKCN-E5、Aigis-sig、Dilithium、Aigis-sig-II
- **3 个编码密码算法**：Classic McEliece、NTS-KEM、BIKE

**格密码主导**：与国际趋势一致，格密码占据绝对优势（11/14）。

## 迁移策略

**混合方案**：
- 同时使用经典算法和后量子算法
- 例如：TLS 1.3 中同时使用 ECDH 和 Kyber
- 确保至少一个方案安全即可

**渐进式升级**：
- 优先保护长期数据（如政府机密、医疗记录）
- 逐步替换现有基础设施
- 测试兼容性和性能

**密码敏捷性**：
- 设计系统时支持算法灵活替换
- 避免硬编码特定算法

## 性能对比

| 方案类型 | 密钥大小 | 签名/密文大小 | 速度 |
|---------|---------|--------------|------|
| RSA-2048 | 中等 | 小 | 中等 |
| ECC-256 | 小 | 小 | 快 |
| Kyber-768 | 小-中等 | 中等 | 快 |
| Dilithium-3 | 中等 | 大 | 快 |
| SPHINCS+ | 小 | 很大 | 慢 |

**总体评价**：格密码方案在性能和安全性之间取得了良好平衡，是最实用的选择。

## 区块链影响

**威胁评估**：
- 所有基于 ECDSA 的区块链（[比特币](https://learnblockchain.cn/tags/比特币?map=BTC)、[以太坊](https://learnblockchain.cn/tags/以太坊?map=EVM)等）易受量子攻击
- 公开公钥的地址（已使用的地址）风险更高
- 未公开公钥的地址（未使用的地址）有哈希保护层

**应对措施**：
- 研发后量子签名方案（如 Lamport、SPHINCS+）
- 考虑迁移到抗量子算法
- 部分项目已开始探索（如 QRL、IOTA）

**挑战：**
- 后量子签名通常更大，增加区块链存储和带宽需求
- 需要硬分叉升级

## 标准采用

**TLS 1.3**：主要浏览器和服务器开始支持混合 PQC 密钥交换。

**Signal**：消息加密协议 PQXDH 集成了 Kyber。

**VPN**：某些 VPN 提供商提供 PQC 选项。

**政府要求**：美国、欧盟等开始要求关键基础设施采用 PQC。

## 推荐阅读

- [NIST Post-Quantum Cryptography Standardization](https://csrc.nist.gov/projects/post-quantum-cryptography)
- [后量子密码学：量子时代的密码学 - 知乎](https://zhuanlan.zhihu.com/p/443821233)
- [中国后量子密码竞赛结果 - 密码学报](http://www.jcr.cacrnet.org.cn/CN/abstract/abstract328.shtml)
- [Post-Quantum Cryptography - Wikipedia](https://en.wikipedia.org/wiki/Post-quantum_cryptography)

## 相关概念

- **量子计算**
- **Shor算法**
- **格密码**
- **CRYSTALS-Kyber**
- **CRYSTALS-Dilithium**
- **量子密钥分发（QKD）**
