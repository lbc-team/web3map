# 公钥密码学

## 概念简介

公钥密码学（Public Key Cryptography），也称非对称密码学（Asymmetric Cryptography），是现代密码学的基石。与对称密码学使用相同密钥加解密不同，公钥密码学使用一对密钥：公钥（Public Key）用于加密或验证签名，私钥（Private Key）用于解密或生成签名。

公钥密码学的概念由 Whitfield Diffie 和 Martin Hellman 在 1976 年的论文《New Directions in Cryptography》中首次提出，开创了现代密码学的新时代。

## 核心特性

**密钥对分离**：
- 公钥可以公开分发，任何人都可以获取
- 私钥必须严格保密，只有所有者知道
- 从公钥在计算上无法推导出私钥

**两大功能**：
1. **加密通信**：用公钥加密，私钥解密，保证机密性
2. **数字签名**：用私钥签名，公钥验证，保证真实性和完整性

## 主要算法

**RSA（Rivest-Shamir-Adleman）**：
- 1977 年由 Rivest、Shamir 和 Adleman 提出
- 基于大整数因式分解的困难性
- 密钥长度通常 2048 位或 3072 位以上
- 既可用于加密也可用于签名

**[椭圆曲线密码学](https://learnblockchain.cn/tags/椭圆曲线密码学)（ECC）**：
- 基于椭圆曲线离散对数问题（ECDLP）
- 相同安全级别下密钥更短：256 位 ECC ≈ 3072 位 RSA
- 计算效率更高，占用空间更小
- 常见曲线：secp256k1（[比特币](https://learnblockchain.cn/tags/比特币?map=BTC)）、secp256r1、Curve25519

**其他算法**：
- DSA/ECDSA：数字签名算法
- ElGamal：基于 Diffie-Hellman 的加密
- EdDSA：Edwards 曲线数字签名（如 Ed25519）

## 数字签名

**工作原理**：
1. 发送方用私钥对消息（或消息哈希）签名
2. 接收方用发送方的公钥验证签名
3. 验证通过则确认消息来自私钥持有者且未被篡改

**应用场景**：
- 软件发布验证（确保软件未被篡改）
- 电子文档签署（法律效力）
- 区块链交易（证明资产所有权）
- SSL/TLS 证书（验证网站身份）

## 在区块链中的应用

**[账户](https://learnblockchain.cn/tags/账户?map=EVM)系统**：
- 私钥 → 公钥 → 地址
- 私钥用于签署交易
- 公钥用于验证签名和生成地址

**[比特币](https://learnblockchain.cn/tags/比特币?map=BTC)**：使用 secp256k1 椭圆曲线和 ECDSA 签名

**[以太坊](https://learnblockchain.cn/tags/以太坊?map=EVM)**：同样使用 secp256k1，地址是公钥哈希的后 160 位

**新一代区块链**：
- [Solana](https://learnblockchain.cn/tags/Solana?map=Solana)、Cardano 等使用 Ed25519
- 更高效的签名验证性能

## 性能对比

| 特性 | 对称加密 | 非对称加密 |
|------|---------|-----------|
| 密钥管理 | 复杂（需安全共享）| 简单（公钥可公开）|
| 速度 | 快（~1000倍）| 慢 |
| 密钥长度 | 短（128-256位）| 长（RSA 2048+, ECC 256+）|
| 用途 | 大量数据加密 | 密钥交换、签名 |

**混合加密**：实践中常用非对称加密交换对称密钥，然后用对称加密传输大量数据，结合两者优势。

## 安全性考虑

**密钥长度建议**（截至 2025 年）：
- RSA：最低 2048 位，推荐 3072 位或 4096 位
- ECC：最低 224 位，推荐 256 位或更高
- 对称加密：最低 128 位，推荐 256 位

**量子威胁**：
- Shor 算法可以在量子计算机上快速分解大整数和解决离散对数
- RSA 和 ECC 在量子计算机面前都不安全
- 需要过渡到后量子密码学算法

**密钥管理**：
- 私钥泄露意味着完全失去安全性
- 需要安全的密钥生成、存储和销毁机制
- 硬件安全模块（HSM）、可信执行环境（TEE）

## 推荐阅读

- [公钥密码学简介 - 维基百科](https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86)
- [理解椭圆曲线密码学（ECC）- 知乎](https://zhuanlan.zhihu.com/p/36326221)
- [RSA加密算法详解 - CSDN](https://blog.csdn.net/jijianshuai/article/details/80582187)
- [区块链中的密码学 - 登链社区](https://learnblockchain.cn/article/2088)

## 相关概念

- **RSA**
- **[椭圆曲线密码学](https://learnblockchain.cn/tags/椭圆曲线密码学)**
- **数字签名**
- **Diffie-Hellman**
- **后量子密码学**
